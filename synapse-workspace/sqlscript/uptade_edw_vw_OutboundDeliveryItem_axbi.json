{
	"name": "uptade_edw_vw_OutboundDeliveryItem_axbi",
	"properties": {
		"content": {
			"query": "CREATE VIEW [edw].[vw_OutboundDeliveryItem_axbi]\n\tAS \nSELECT\n    CONCAT_WS('Â¦', FCust.[PACKINGSLIPID] collate SQL_Latin1_General_CP1_CS_AS, FCust.[INVENTTRANSID] collate SQL_Latin1_General_CP1_CS_AS) as [nk_fact_OutboundDeliveryItem],\n\tFCust.[PACKINGSLIPID]                                                        as [OutboundDelivery],\n    SO.[target_SalesOrganizationID]                                              as [HDR_SalesOrganizationID], \n    FCust.[ORIGSALESID]                                                          as [ReferenceSDDocument],\n    FCust.[DELIVERYDATE]                                                         as [HDR_DeliveryDate], \n    FCust.[INVENTTRANSID]                                                        as [ReferenceSDDocumentItem], --INVENTTRANSID\n    RIGHT('000000000000000000' + mapMaterial.[target_Material], 18)              as [ProductID],\n    DimCust.[CustomerID]                                                         as [HDR_SoldToPartyID],\n    FCust.[CURRENCYCODE_CZ]                                                      as [SDI_LocalCurrency],\n    FCust.[SHIPPINGDATEREQUESTED]                                                as [SDI_RequestedDeliveryDate],\n    FCust.[SHIPPINGDATECONFIRMED_tf]                                             as [SL_ConfirmedDeliveryDate],\n    NULL                                                                         as [PlantId], -- FCust.[INVENTSITEID],\n    NULL                                                                         as [WarehouseId], -- FCust.[INVENTLOCATIONID],\n    \n    format((row_number()  \n    over (partition by FCust.[PACKINGSLIPID] \n    order by FCust.[DELIVERYDATE]))*10,'000000')                                 as [OutboundDeliveryItem], --INVENTTRANSID\n\n    FCust.[QTY]                                                                  as [ActualDeliveryQuantity],\n    case when \n         FCust.[QTY] > 0 \n    then FCust.[HPLCOSTPRICE] / FCust.[QTY]                       \n    else 0 end                                                                   as [SDI_PricePerPiece_LC],\n\n    case\n    when FCust.[DATAAREAID] = FSL.[DATAAREAID]\n        and\n        FCust.[ORIGSALESID] = FSL.[SALESID]\n        and\n        FCust.[INVENTTRANSID] = FSL.[INVENTTRANSID]\n        then FSL.[SALESQTY]\n    else 0 end                                                                   as SL_ConfdOrderQtyByMatlAvailCheck,\n\n    case\n    when FCust.[DELIVERYDATE] = FCust.[SHIPPINGDATECONFIRMED_tf]\n        then 1\n    else 0\n    end\n                                                                                 as [IsOnTimeDelivery],\n    case\n    when FSL.[SALESQTY] = FCust.[QTY]\n        then 1\n    else 0\n    end                                                                          as [IsInFull],\n\n    case\n    when FCust.[DELIVERYDATE] < FCust.[SHIPPINGDATECONFIRMED_tf]\n        then DATEDIFF(day, FCust.[DELIVERYDATE], FCust.[SHIPPINGDATECONFIRMED_tf])\n    else 0\n    end                                                                         as [DeliveredEarlyDays],\n\n    case\n    when FCust.[DELIVERYDATE] > FCust.[SHIPPINGDATECONFIRMED_tf]\n        then DATEDIFF(day, FCust.[DELIVERYDATE], FCust.[SHIPPINGDATECONFIRMED_tf])   \n    else 0\n    end                                                                        as [DeliveredLateDays],\n\n    case\n    when FCust.[DELIVERYDATE] < FCust.[SHIPPINGDATECONFIRMED_tf]\n        then 1\n    else 0\n    end                                                                      as [IsEarlyDelivered],\n    case\n    when FCust.[DELIVERYDATE] > FCust.[SHIPPINGDATECONFIRMED_tf]\n        then 1\n    else 0\n    end                                                                      as [IsLateDelivered],\n\n    FCust.[t_applicationId],\n    FCust.[t_extractionDtm]\nFROM \n    [base_tx_halfen_2_dwh].[FACT_CUSTPACKINGSLIPTRANS] FCust\n    LEFT JOIN\n        [map_AXBI].[SalesOrganization] AS SO\n        ON\n            FCust.[DATAAREAID] = SO.[source_DataAreaID] \n    LEFT JOIN\n        [map_AXBI].[Material] as mapMaterial\n        ON\n            -- FCust.[DATAAREAID] = upper(SINMT.[AXDataAreaId])  \n            -- AND\n            FCust.[ITEMID] = mapMaterial.[source_Material]  \n    LEFT JOIN\n        [base_dw_halfen_0_hlp].[SAPCustomerBasicMappingTable] as SCMT\n        ON\n            FCust.[DATAAREAID] = upper(SCMT.[AXDataAreaId]) \n            AND\n            FCust.[ORDERACCOUNT] = SCMT.[AXCustomeraccount]\n    LEFT JOIN\n        [edw].[dim_Customer] DimCust\n        ON\n            DimCust.[CustomerExternalID] = SCMT.[SAPCustomeraccount]\n\n    LEFT JOIN intm_axbi.vw_FACT_SALESLINE FSL\n        ON \n            FSL.[INVENTTRANSID] = FCust.[INVENTTRANSID]  \n            AND \n            FSL.[DATAAREAID] = FCust.[DATAAREAID]\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "sqlserverless",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}