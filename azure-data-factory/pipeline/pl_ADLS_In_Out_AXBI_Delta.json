{
	"name": "pl_ADLS_In_Out_AXBI_Delta",
	"properties": {
		"activities": [
			{
				"name": "Copy from ADLS In to Out",
				"description": "",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlDWSource",
						"sqlReaderQuery": {
							"value": "SELECT --top(5000)\n    new.Invoiceno,\n    new.Posno,\n    'U' AS Flg\nFROM\n    OPENROWSET(\n        BULK 'https://stxxxxslsdeuw001.dfs.core.windows.net/@{pipeline().parameters.adls_container_name}/@{pipeline().parameters.new_adls_directory_path}/@{pipeline().parameters.new_file_name}',\n        FORMAT = 'PARQUET'\n    ) AS [new]\nINNER JOIN\n    OPENROWSET(\n        BULK 'https://stxxxxslsdeuw001.dfs.core.windows.net/@{pipeline().parameters.adls_container_name}/@{pipeline().parameters.current_adls_directory_path}/@{pipeline().parameters.current_file_name}',\n        FORMAT = 'PARQUET'\n    ) AS [current]\n    ON \n        new.[Invoiceno] = [current].[Invoiceno]\n        AND\n        new.[Posno] = [current].[Posno]\n\t    AND\n\t\tCHECKSUM( \n            new.[Company],\n            new.[Distributioncompany],\n            new.[Salesarea],\n            new.[Inside_Outside],\n            new.[Inside_Outside-Text],\n            new.[Site],\n            -- new.[Invoiceno],\n            new.[Invoicedate],\n            new.[Accountingdate],\n            new.[Year],\n            new.[Month],\n            new.[Day],\n            new.[Orderno],\n            new.[Deliveryno],\n            -- new.[Posno],\n            new.[Orderdate],\n            new.[Deldateplan],\n            new.[Deldateconfirmed],\n            new.[Deldateact],\n            new.[SalesType],\n            new.[Customerno],\n            new.[Country],\n            new.[Postalcode],\n            new.[DlvCountry],\n            new.[DlvState],\n            new.[DlvCounty],\n            new.[Mainsalesperson],\n            new.[Salesperson],\n            new.[Maindistrict],\n            new.[Salesdistrict],\n            new.[Lineofbusiness],\n            new.[Concern],\n            new.[I_E_V],\n            new.[I_E_V-Text],\n            new.[Responsible],\n            new.[Warehouse],\n            new.[Aquisitioncode],\n            new.[Aquisitioncode-Text],\n            new.[Originwarehouse],\n            new.[OriginAquisitioncode],\n            new.[OriginAquisitioncode-Text],\n            new.[Itemno],\n            new.[Productsub_group],\n            new.[Itemtype],\n            new.[Productgroup],\n            new.[Productline],\n            new.[Productrange],\n            new.[CRHProductGroupID],\n            new.[Production_Purchase],\n            new.[Stainlesssteelflag],\n            new.[Stainlesssteel-Text],\n            new.[MainProductclass],\n            new.[Productclass],\n            new.[Configno],\n            new.[Pricelistno],\n            new.[Projectno],\n            new.[ProjectPos],\n            new.[Kitheaderno],\n            new.[Bruttosaleslocal],\n            new.[BruttosalesCRHEUR],\n            new.[Brutto2saleslocal],\n            new.[Brutto2salesCRHEUR],\n            new.[Nettosalesposlocal],\n            new.[NettosalesposCRHEUR],\n            new.[Linepercentweighted],\n            new.[Invoicedsaleslocal],\n            new.[InvoicedsalesCRHEUR],\n            new.[Othersaleslocal],\n            new.[OthersalesCRHEUR],\n            new.[Allowanceslocal],\n            new.[AllowancesCRHEUR],\n            new.[Sales100%local],\n            new.[Sales100%CRHEUR],\n            new.[TZlocal],\n            new.[TZCRHEUR],\n            new.[TZpercent],\n            new.[LZlocal],\n            new.[LZCRHEUR],\n            new.[LZpercent],\n            new.[Linediscount1local],\n            new.[Linediscount1CRHEUR],\n            new.[Linediscount1percent],\n            new.[Linediscount2local],\n            new.[Linediscount2CRHEUR],\n            new.[Linediscount2percent],\n            new.[Orderdiscountlocal],\n            new.[OrderdiscountCRHEUR],\n            new.[Orderdiscountpercent],\n            new.[Productsaleslocal],\n            new.[ProductsalesCRHEUR],\n            new.[Plantsellingpricelocal],\n            new.[PlantsellingpriceCRHEUR],\n            new.[ICPlocal],\n            new.[ICPCRHEUR],\n            new.[SMClocal],\n            new.[SMCCRHEUR],\n            new.[SMCsumlocal],\n            new.[SMCsumCRHEUR],\n            new.[Variablesellingcostslocal],\n            new.[VariablesellingcostsCRHEUR],\n            new.[Netsaleslocal],\n            new.[NetsalesCRHEUR],\n            new.[Grossmarginlocal],\n            new.[GrossmarginCRHEUR],\n            new.[contribmarginIIdclocal],\n            new.[contribmarginIIdcCRHEUR],\n            new.[contribmarginIIholocal],\n            new.[contribmarginIIhoCRHEUR],\n            new.[Plantoverheadcostslocal],\n            new.[PlantoverheadcostsCRHEUR],\n            new.[contribmarginIIIlocal],\n            new.[contribmarginIIICRHEUR],\n            new.[Invoicequantity],\n            new.[Orderquantity],\n            new.[Netweight],\n            new.[Freightinvoicedlocal],\n            new.[FreightinvoicedCRHEUR],\n            new.[Tollinvoicedlocal],\n            new.[TollinvoicedCRHEUR],\n            new.[Packingsinvoicedlocal],\n            new.[PackingsinvoicedCRHEUR],\n            new.[Surchargeonshortquantitylocal],\n            new.[SurchargeonshortquantityCRHEUR],\n            new.[Planningcostsinvoicedlocal],\n            new.[PlanningcostsinvoicedCRHEUR],\n            new.[Packingdepositlocal],\n            new.[PackingdepositCRHEUR],\n            new.[Miscellaneousproceedsinvoicedlocal],\n            new.[MiscellaneousproceedsinvoicedCRHEUR],\n            new.[Reservecustomerbonuslocal],\n            new.[ReservecustomerbonusCRHEUR],\n            new.[Warrentieslocal],\n            new.[WarrentiesCRHEUR],\n            new.[Marketingcostsallowanceslocal],\n            new.[MarketingcostsallowancesCRHEUR],\n            new.[Reservecustomerdiscountlocal],\n            new.[ReservecustomerdiscountCRHEUR],\n            new.[Freightcostslocal],\n            new.[FreightcostsCRHEUR],\n            new.[Packingcostslocal],\n            new.[PackingcostsCRHEUR],\n            new.[Dutieslocal],\n            new.[DutiesCRHEUR],\n            new.[Insurancelocal],\n            new.[InsuranceCRHEUR],\n            new.[Commissionslocal],\n            new.[CommissionsCRHEUR],\n            new.[Licenceslocal],\n            new.[LicencesCRHEUR],\n            new.[SMCordinarysteellocal],\n            new.[SMCordinarysteelCRHEUR],\n            new.[SMCstainlesssteellocal],\n            new.[SMCstainlesssteelCRHEUR],\n            new.[SMCotherrawmateriallocal],\n            new.[SMCotherrawmaterialCRHEUR],\n            new.[SMCmaterialoverheadcostslocal],\n            new.[SMCmaterialoverheadcostsCRHEUR],\n            new.[SMCalloysurchargelocal],\n            new.[SMCalloysurchargeCRHEUR],\n            new.[SMCexternalproductioncostslocal],\n            new.[SMCexternalproductioncostsCRHEUR],\n            new.[SMCvariableproductioncostslocal],\n            new.[SMCvariableproductioncostsCRHEUR],\n            new.[SMCfixedproductioncostslocal],\n            new.[SMCfixedproductioncostsCRHEUR],\n            new.[CostsofcapitalE01local],\n            new.[CostsofcapitalE01CRHEUR],\n            new.[WarehousechargesE02local],\n            new.[WarhousechargesE02CRHEUR],\n            new.[HandlingchargesE03local],\n            new.[HandlingchargesE03CRHEUR],\n            new.[PackagingchargesE04local],\n            new.[PackagingchargesE04CRHEUR],\n            new.[PlantoverheadE05local],\n            new.[PlantoverheadE05CRHEUR],\n            new.[E06local],\n            new.[E06CRHEUR],\n            new.[E07local],\n            new.[E07CRHEUR],\n            new.[PlantprofitE08local],\n            new.[PlantprofitE08CRHEUR],\n            new.[ICsurchargeE09local],\n            new.[ICsurchargeE09CRHEUR],\n            new.[FreightsurchargeE10local],\n            new.[FreightsurchargeE10CRHEUR],\n            new.[Freightdctocustomerlocal],\n            new.[FreightdctocustomerCRHEUR],\n            new.[FreightAR_LAtodclocal],\n            new.[FreightAR_LAtodcCRHEUR],\n            new.[FreightPNtoAR_LAlocal],\n            new.[FreightPNtoAR_LACRHEUR],\n            new.[DAN502],\n            new.[DAN503],\n            new.[DAA705],\n            new.[LengthinMper1],\n            new.[LengthinM],\n            new.[Freight_Tollinvoicedlocal],\n            new.[Freight_TollinvoicedCRHEUR],\n            new.[Packaginginvoicedlocal],\n            new.[PackaginginvoicedCRHEUR],\n            new.[Grosssaleslocal],\n            new.[GrosssalesCRHEUR],\n            new.[CostCenter],\n            new.[DAGRWE],\n            new.[CurrencyRatelocaltoCRH1EUR],\n            new.[CurrencyEUR],\n            new.[Currencylocal],\n            new.[Salespersonname],\n            new.[Salesdistrictname],\n            new.[Projectname],\n            new.[Projectdeliverycountry],\n            new.[Projectdeliverycity],\n            new.[Companycountrycode],\n            new.[Companycountryname]--,\n            -- new.[DW_Batch],\n            -- new.[DW_SourceCode],\n            -- new.[DW_TimeStamp]\n        ) <> \n\t\tCHECKSUM( \n\t\t\t[current].[Company],\n            [current].[Distributioncompany],\n            [current].[Salesarea],\n            [current].[Inside_Outside],\n            [current].[Inside_Outside-Text],\n            [current].[Site],\n            -- [current].[Invoiceno],\n            [current].[Invoicedate],\n            [current].[Accountingdate],\n            [current].[Year],\n            [current].[Month],\n            [current].[Day],\n            [current].[Orderno],\n            [current].[Deliveryno],\n            -- [current].[Posno],\n            [current].[Orderdate],\n            [current].[Deldateplan],\n            [current].[Deldateconfirmed],\n            [current].[Deldateact],\n            [current].[SalesType],\n            [current].[Customerno],\n            [current].[Country],\n            [current].[Postalcode],\n            [current].[DlvCountry],\n            [current].[DlvState],\n            [current].[DlvCounty],\n            [current].[Mainsalesperson],\n            [current].[Salesperson],\n            [current].[Maindistrict],\n            [current].[Salesdistrict],\n            [current].[Lineofbusiness],\n            [current].[Concern],\n            [current].[I_E_V],\n            [current].[I_E_V-Text],\n            [current].[Responsible],\n            [current].[Warehouse],\n            [current].[Aquisitioncode],\n            [current].[Aquisitioncode-Text],\n            [current].[Originwarehouse],\n            [current].[OriginAquisitioncode],\n            [current].[OriginAquisitioncode-Text],\n            [current].[Itemno],\n            [current].[Productsub_group],\n            [current].[Itemtype],\n            [current].[Productgroup],\n            [current].[Productline],\n            [current].[Productrange],\n            [current].[CRHProductGroupID],\n            [current].[Production_Purchase],\n            [current].[Stainlesssteelflag],\n            [current].[Stainlesssteel-Text],\n            [current].[MainProductclass],\n            [current].[Productclass],\n            [current].[Configno],\n            [current].[Pricelistno],\n            [current].[Projectno],\n            [current].[ProjectPos],\n            [current].[Kitheaderno],\n            [current].[Bruttosaleslocal],\n            [current].[BruttosalesCRHEUR],\n            [current].[Brutto2saleslocal],\n            [current].[Brutto2salesCRHEUR],\n            [current].[Nettosalesposlocal],\n            [current].[NettosalesposCRHEUR],\n            [current].[Linepercentweighted],\n            [current].[Invoicedsaleslocal],\n            [current].[InvoicedsalesCRHEUR],\n            [current].[Othersaleslocal],\n            [current].[OthersalesCRHEUR],\n            [current].[Allowanceslocal],\n            [current].[AllowancesCRHEUR],\n            [current].[Sales100%local],\n            [current].[Sales100%CRHEUR],\n            [current].[TZlocal],\n            [current].[TZCRHEUR],\n            [current].[TZpercent],\n            [current].[LZlocal],\n            [current].[LZCRHEUR],\n            [current].[LZpercent],\n            [current].[Linediscount1local],\n            [current].[Linediscount1CRHEUR],\n            [current].[Linediscount1percent],\n            [current].[Linediscount2local],\n            [current].[Linediscount2CRHEUR],\n            [current].[Linediscount2percent],\n            [current].[Orderdiscountlocal],\n            [current].[OrderdiscountCRHEUR],\n            [current].[Orderdiscountpercent],\n            [current].[Productsaleslocal],\n            [current].[ProductsalesCRHEUR],\n            [current].[Plantsellingpricelocal],\n            [current].[PlantsellingpriceCRHEUR],\n            [current].[ICPlocal],\n            [current].[ICPCRHEUR],\n            [current].[SMClocal],\n            [current].[SMCCRHEUR],\n            [current].[SMCsumlocal],\n            [current].[SMCsumCRHEUR],\n            [current].[Variablesellingcostslocal],\n            [current].[VariablesellingcostsCRHEUR],\n            [current].[Netsaleslocal],\n            [current].[NetsalesCRHEUR],\n            [current].[Grossmarginlocal],\n            [current].[GrossmarginCRHEUR],\n            [current].[contribmarginIIdclocal],\n            [current].[contribmarginIIdcCRHEUR],\n            [current].[contribmarginIIholocal],\n            [current].[contribmarginIIhoCRHEUR],\n            [current].[Plantoverheadcostslocal],\n            [current].[PlantoverheadcostsCRHEUR],\n            [current].[contribmarginIIIlocal],\n            [current].[contribmarginIIICRHEUR],\n            [current].[Invoicequantity],\n            [current].[Orderquantity],\n            [current].[Netweight],\n            [current].[Freightinvoicedlocal],\n            [current].[FreightinvoicedCRHEUR],\n            [current].[Tollinvoicedlocal],\n            [current].[TollinvoicedCRHEUR],\n            [current].[Packingsinvoicedlocal],\n            [current].[PackingsinvoicedCRHEUR],\n            [current].[Surchargeonshortquantitylocal],\n            [current].[SurchargeonshortquantityCRHEUR],\n            [current].[Planningcostsinvoicedlocal],\n            [current].[PlanningcostsinvoicedCRHEUR],\n            [current].[Packingdepositlocal],\n            [current].[PackingdepositCRHEUR],\n            [current].[Miscellaneousproceedsinvoicedlocal],\n            [current].[MiscellaneousproceedsinvoicedCRHEUR],\n            [current].[Reservecustomerbonuslocal],\n            [current].[ReservecustomerbonusCRHEUR],\n            [current].[Warrentieslocal],\n            [current].[WarrentiesCRHEUR],\n            [current].[Marketingcostsallowanceslocal],\n            [current].[MarketingcostsallowancesCRHEUR],\n            [current].[Reservecustomerdiscountlocal],\n            [current].[ReservecustomerdiscountCRHEUR],\n            [current].[Freightcostslocal],\n            [current].[FreightcostsCRHEUR],\n            [current].[Packingcostslocal],\n            [current].[PackingcostsCRHEUR],\n            [current].[Dutieslocal],\n            [current].[DutiesCRHEUR],\n            [current].[Insurancelocal],\n            [current].[InsuranceCRHEUR],\n            [current].[Commissionslocal],\n            [current].[CommissionsCRHEUR],\n            [current].[Licenceslocal],\n            [current].[LicencesCRHEUR],\n            [current].[SMCordinarysteellocal],\n            [current].[SMCordinarysteelCRHEUR],\n            [current].[SMCstainlesssteellocal],\n            [current].[SMCstainlesssteelCRHEUR],\n            [current].[SMCotherrawmateriallocal],\n            [current].[SMCotherrawmaterialCRHEUR],\n            [current].[SMCmaterialoverheadcostslocal],\n            [current].[SMCmaterialoverheadcostsCRHEUR],\n            [current].[SMCalloysurchargelocal],\n            [current].[SMCalloysurchargeCRHEUR],\n            [current].[SMCexternalproductioncostslocal],\n            [current].[SMCexternalproductioncostsCRHEUR],\n            [current].[SMCvariableproductioncostslocal],\n            [current].[SMCvariableproductioncostsCRHEUR],\n            [current].[SMCfixedproductioncostslocal],\n            [current].[SMCfixedproductioncostsCRHEUR],\n            [current].[CostsofcapitalE01local],\n            [current].[CostsofcapitalE01CRHEUR],\n            [current].[WarehousechargesE02local],\n            [current].[WarhousechargesE02CRHEUR],\n            [current].[HandlingchargesE03local],\n            [current].[HandlingchargesE03CRHEUR],\n            [current].[PackagingchargesE04local],\n            [current].[PackagingchargesE04CRHEUR],\n            [current].[PlantoverheadE05local],\n            [current].[PlantoverheadE05CRHEUR],\n            [current].[E06local],\n            [current].[E06CRHEUR],\n            [current].[E07local],\n            [current].[E07CRHEUR],\n            [current].[PlantprofitE08local],\n            [current].[PlantprofitE08CRHEUR],\n            [current].[ICsurchargeE09local],\n            [current].[ICsurchargeE09CRHEUR],\n            [current].[FreightsurchargeE10local],\n            [current].[FreightsurchargeE10CRHEUR],\n            [current].[Freightdctocustomerlocal],\n            [current].[FreightdctocustomerCRHEUR],\n            [current].[FreightAR_LAtodclocal],\n            [current].[FreightAR_LAtodcCRHEUR],\n            [current].[FreightPNtoAR_LAlocal],\n            [current].[FreightPNtoAR_LACRHEUR],\n            [current].[DAN502],\n            [current].[DAN503],\n            [current].[DAA705],\n            [current].[LengthinMper1],\n            [current].[LengthinM],\n            [current].[Freight_Tollinvoicedlocal],\n            [current].[Freight_TollinvoicedCRHEUR],\n            [current].[Packaginginvoicedlocal],\n            [current].[PackaginginvoicedCRHEUR],\n            [current].[Grosssaleslocal],\n            [current].[GrosssalesCRHEUR],\n            [current].[CostCenter],\n            [current].[DAGRWE],\n            [current].[CurrencyRatelocaltoCRH1EUR],\n            [current].[CurrencyEUR],\n            [current].[Currencylocal],\n            [current].[Salespersonname],\n            [current].[Salesdistrictname],\n            [current].[Projectname],\n            [current].[Projectdeliverycountry],\n            [current].[Projectdeliverycity],\n            [current].[Companycountrycode],\n            [current].[Companycountryname]--,\n            -- [current].[DW_Batch],\n            -- [current].[DW_SourceCode],\n            -- [current].[DW_TimeStamp]\n        )\n\nUNION ALL\n\nSELECT --top(5000)\n    new.Invoiceno,\n    new.Posno,\n    'I' AS Flg\nFROM\n    OPENROWSET(\n        BULK 'https://stxxxxslsdeuw001.dfs.core.windows.net/@{pipeline().parameters.adls_container_name}/@{pipeline().parameters.new_adls_directory_path}/@{pipeline().parameters.new_file_name}',\n        FORMAT = 'PARQUET'\n    ) AS [new]\nLEFT JOIN\n    OPENROWSET(\n        BULK 'https://stxxxxslsdeuw001.dfs.core.windows.net/@{pipeline().parameters.adls_container_name}/@{pipeline().parameters.current_adls_directory_path}/@{pipeline().parameters.current_file_name}',\n        FORMAT = 'PARQUET'\n    ) AS [current]\n    ON\n        [new].[Invoiceno] = [current].[Invoiceno]\n        AND\n        [new].[Posno] = [current].[Posno]\nWHERE \n    [current].[Invoiceno] IS NULL\n    AND\n    [current].[Posno] IS NULL\n\nUNION ALL\n\nSELECT --top(5000)\n    [current].Invoiceno,\n    [current].Posno,\n    'D' AS Flg\nFROM\n    OPENROWSET(\n        BULK 'https://stxxxxslsdeuw001.dfs.core.windows.net/@{pipeline().parameters.adls_container_name}/@{pipeline().parameters.current_adls_directory_path}/@{pipeline().parameters.current_file_name}',\n        FORMAT = 'PARQUET'\n    ) AS [current]\nLEFT JOIN\n    OPENROWSET(\n        BULK 'https://stxxxxslsdeuw001.dfs.core.windows.net/@{pipeline().parameters.adls_container_name}/@{pipeline().parameters.new_adls_directory_path}/@{pipeline().parameters.new_file_name}',\n        FORMAT = 'PARQUET'\n    ) AS [new]\n    ON \n        new.[Invoiceno] = [current].[Invoiceno]\n        AND\n        new.[Posno] = [current].[Posno]\nWHERE \n    [new].[Invoiceno] IS NULL\n    AND\n    [new].[Posno] IS NULL",
							"type": "Expression"
						},
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "ParquetSink",
						"storeSettings": {
							"type": "AzureBlobFSWriteSettings"
						},
						"formatSettings": {
							"type": "ParquetWriteSettings"
						}
					},
					"enableStaging": false
				},
				"inputs": [
					{
						"referenceName": "ds_synod__synapse_od",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "ds_adls_parquet_file",
						"type": "DatasetReference",
						"parameters": {
							"container": {
								"value": "@pipeline().parameters.adls_container_name",
								"type": "Expression"
							},
							"directory": {
								"value": "@pipeline().parameters.target_adls_directory_path",
								"type": "Expression"
							},
							"file": {
								"value": "@pipeline().parameters.new_file_name",
								"type": "Expression"
							}
						}
					}
				]
			}
		],
		"parameters": {
			"current_adls_directory_path": {
				"type": "string",
				"defaultValue": "FACT_HGDAWA/In/2022/07/08"
			},
			"current_file_name": {
				"type": "string",
				"defaultValue": "FACT_HGDAWA_2022_07_08_08_23_39_946.parquet"
			},
			"adls_container_name": {
				"type": "string",
				"defaultValue": "dw-halfen-2-dwh-uat"
			},
			"new_file_name": {
				"type": "string",
				"defaultValue": "FACT_HGDAWA_2022_07_13_14_37_16_907.parquet"
			},
			"new_adls_directory_path": {
				"type": "string",
				"defaultValue": "FACT_HGDAWA/In/2022/07/13"
			},
			"target_adls_directory_path": {
				"type": "string",
				"defaultValue": "FACT_HGDAWA/Delta/2022/07/13"
			}
		},
		"variables": {
			"batch_id": {
				"type": "String",
				"defaultValue": "@guid()"
			},
			"additional_columns": {
				"type": "String"
			}
		},
		"folder": {
			"name": "00 ELT/03 ADLS Transformation/AXBI"
		},
		"annotations": [],
		"lastPublishTime": "2021-10-25T15:25:00Z"
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}