parameters:
- name: solutions
  type: object
  default:
  - name: 'synapse-dwh'
    build: true
  - name: 'azure-data-factory'
    build: true
  - name: 'orchestration'
    build: true
  - name: 'xu-config'
    build: true
  - name: 'synapse-workspace'
    build: true

jobs:
- ${{ each solution in parameters.solutions }}:
  - ${{ if solution.build }}:
    - job: BUILD_${{ upper(replace(solution.name, '-', '_')) }}
      pool:
        name: 'VM'
        demands:
        - node.js
        - VisualStudio
        - Agent.ComputerName -equals $(VMName)
      steps:
      - template: ../${{ solution.name }}/build/steps-build.yml
      - template: ../${{ solution.name }}/build/steps-artifact.yml