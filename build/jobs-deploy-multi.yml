parameters:
- name: solutions
  type: object
  default:
  - name: 'synapse-dwh'
    deploy: True
    test: True
  - name: 'orchestration'
    deploy: True
    test: False
  - name: 'xu-config'
    deploy: True
    test: False
  - name: 'synapse-workspace'
    deploy: True
    test: False
- name: deployEnvPrefix
  type: string


jobs:
- ${{ each solution in parameters.solutions }}:
  
  - job:
    steps:
    - bash: echo ${{ solution.deploy }}
  # solution.deploy is not an actual boolean (part of parameter.solutions object)
  # so include additional check if equal to True (string)
  - ${{ if eq(solution.deploy, True) }}:
    - template: ./jobs-deploy-solution.yml
      parameters:
        folder: ${{ solution.name }}
        solution: ${{ upper(replace( solution.name, '-', '_')) }}
        deployEnvPrefix: ${{ parameters.deployEnvPrefix }}
        # solution.test is not an actual boolean (part of parameter.solutions object)
        # so include additional check if equal to True (string)
        # test: ${{ eq(solution.test, True) }}