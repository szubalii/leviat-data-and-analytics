CREATE VIEW [edw].[vw_BillingDocumentItem_for_SalesDocumentItem]
AS
SELECT 
    BDI.[BillingDocument]                      
    ,BDI.[BillingDocumentItem]                  
    ,BDI.[CurrencyTypeID]                       
    ,BDI.[CurrencyType]                         
    ,BDI.[CurrencyID]                           
    ,BDI.[ExchangeRate]                         
    ,BDI.[SalesDocumentItemCategoryID]          
    ,BDI.[SalesDocumentItemTypeID]              
    ,BDI.[ReturnItemProcessingType]             
    ,BDI.[BillingDocumentTypeID]                
    ,BDI.[BillingDocumentCategoryID]            
    ,BDI.[SDDocumentCategoryID]                 
    ,BDI.[CreationDate]                         
    ,BDI.[CreationTime]                         
    ,BDI.[LastChangeDate]                       
    ,BDI.[BillingDocumentDate]                  
    ,BDI.[BillingDocumentIsTemporary]           
    ,BDI.[OrganizationDivision]                 
    ,BDI.[Division]                             
    ,BDI.[SalesOfficeID]                        
    ,BDI.[SalesOrganizationID]                  
    ,BDI.[DistributionChannelID]                
    ,BDI.[Material]                             
    ,BDI.[ProductSurrogateKey]                  
    ,BDI.[OriginallyRequestedMaterial]          
    ,BDI.[InternationalArticleNumber]           
    ,BDI.[PricingReferenceMaterial]             
    ,BDI.[LengthInMPer1]                        
    ,BDI.[LengthInM]                            
    ,BDI.[Batch]                                
    ,BDI.[MaterialGroupID]                      
    ,BDI.[BrandID]                              
    ,BDI.[Brand]                                
    ,BDI.[AdditionalMaterialGroup2]             
    ,BDI.[AdditionalMaterialGroup3]             
    ,BDI.[AdditionalMaterialGroup4]             
    ,BDI.[AdditionalMaterialGroup5]             
    ,BDI.[MaterialCommissionGroup]              
    ,BDI.[PlantID]                              
    ,BDI.[StorageLocationID]                    
    ,BDI.[BillingDocumentIsCancelled]           
    ,BDI.[CancelledBillingDocument]             
    ,BDI.[CancelledInvoiceEffect]               
    ,BDI.[BillingDocumentItemText]              
    ,BDI.[ServicesRenderedDate]                 
    ,BDI.[BillingQuantity]                      
    ,BDI.[BillingQuantityUnitID]                
    ,BDI.[BillingQuantityInBaseUnit]            
    ,BDI.[BaseUnit]                             
    ,BDI.[MRPRequiredQuantityInBaseUnit]        
    ,BDI.[BillingToBaseQuantityDnmntr]          
    ,BDI.[BillingToBaseQuantityNmrtr]           
    ,BDI.[ItemGrossWeight]                      
    ,BDI.[ItemNetWeight]                        
    ,BDI.[ItemWeightUnit]                       
    ,BDI.[ItemVolume]                           
    ,BDI.[ItemVolumeUnit]                       
    ,BDI.[BillToPartyCountry]                   
    ,BDI.[BillToPartyRegion]                    
    ,BDI.[BillingPlanRule]                      
    ,BDI.[BillingPlan]                          
    ,BDI.[BillingPlanItem]                      
    ,BDI.[CustomerPriceGroupID]                 
    ,BDI.[PriceListTypeID]                      
    ,BDI.[TaxDepartureCountry]                  
    ,BDI.[VATRegistration]                      
    ,BDI.[VATRegistrationCountry]               
    ,BDI.[VATRegistrationOrigin]                
    ,BDI.[CustomerTaxClassification1]           
    ,BDI.[CustomerTaxClassification2]           
    ,BDI.[CustomerTaxClassification3]           
    ,BDI.[CustomerTaxClassification4]           
    ,BDI.[CustomerTaxClassification5]           
    ,BDI.[CustomerTaxClassification6]           
    ,BDI.[CustomerTaxClassification7]           
    ,BDI.[CustomerTaxClassification8]           
    ,BDI.[CustomerTaxClassification9]           
    ,BDI.[SDPricingProcedure]                   
    ,BDI.[NetAmount]                            
    ,BDI.[TransactionCurrencyID]                
    ,BDI.[GrossAmount]                          
    ,BDI.[PricingDate]                          
    ,BDI.[PriceDetnExchangeRate]                
    ,BDI.[PricingScaleQuantityInBaseUnit]       
    ,BDI.[TaxAmount]                            
    ,BDI.[CostAmount]                           
    ,BDI.[Subtotal1Amount]                      
    ,BDI.[Subtotal2Amount]                      
    ,BDI.[Subtotal3Amount]                      
    ,BDI.[Subtotal4Amount]                      
    ,BDI.[Subtotal5Amount]                      
    ,BDI.[Subtotal6Amount]                      
    ,BDI.[StatisticalValueControl]              
    ,BDI.[StatisticsExchangeRate]               
    ,BDI.[StatisticsCurrency]                   
    ,BDI.[SalesOrganizationCurrency]            
    ,BDI.[EligibleAmountForCashDiscount]        
    ,BDI.[ContractAccount]                      
    ,BDI.[CustomerPaymentTerms]                 
    ,BDI.[PaymentMethod]                        
    ,BDI.[PaymentReference]                     
    ,BDI.[FixedValueDate]                       
    ,BDI.[AdditionalValueDays]                  
    ,BDI.[PayerParty]                           
    ,BDI.[CompanyCode]                          
    ,BDI.[FiscalYear]                           
    ,BDI.[FiscalPeriod]                         
    ,BDI.[CustomerAccountAssignmentGroupID]     
    ,BDI.[BusinessArea]                         
    ,BDI.[ProfitCenter]                         
    ,BDI.[OrderID]                              
    ,BDI.[ControllingArea]                      
    ,BDI.[ProfitabilitySegment]                 
    ,BDI.[CostCenter]                           
    ,BDI.[OriginSDDocument]                     
    ,BDI.[OriginSDDocumentItem]                 
    ,BDI.[PriceDetnExchangeRateDate]            
    ,BDI.[ExchangeRateTypeID]                   
    ,BDI.[FiscalYearVariant]                    
    ,BDI.[CompanyCodeCurrencyID]                
    ,BDI.[AccountingExchangeRate]               
    ,BDI.[AccountingExchangeRateIsSet]          
    ,BDI.[ReferenceSDDocument]                  
    ,BDI.[ReferenceSDDocumentItem]              
    ,BDI.[ReferenceSDDocumentCategoryID]        
    ,BDI.[SalesDocumentID]                      
    ,BDI.[SalesDocumentItemID]                  
    ,BDI.[SalesSDDocumentCategoryID]            
    ,BDI.[HigherLevelItem]                      
    ,BDI.[BillingDocumentItemInPartSgmt]        
    ,BDI.[SalesGroup]                           
    ,BDI.[AdditionalCustomerGroup1]             
    ,BDI.[AdditionalCustomerGroup2]             
    ,BDI.[AdditionalCustomerGroup3]             
    ,BDI.[AdditionalCustomerGroup4]             
    ,BDI.[AdditionalCustomerGroup5]             
    ,BDI.[SDDocumentReasonID]                   
    ,BDI.[ItemIsRelevantForCredit]              
    ,BDI.[CreditRelatedPrice]                   
    ,BDI.[SalesDistrictID]                      
    ,BDI.[CustomerGroupID]                      
    ,BDI.[SoldToParty]                          
    ,BDI.[CountryID]                            
    ,BDI.[ShipToParty]                          
    ,BDI.[BillToParty]                          
    ,BDI.[ShippingPoint]                        
    ,BDI.[IncotermsVersion]                     
    ,BDI.[IncotermsClassification]              
    ,BDI.[IncotermsTransferLocation]            
    ,BDI.[IncotermsLocation1]                   
    ,BDI.[IncotermsLocation2]                   
    ,BDI.[ShippingCondition]                    
    ,BDI.[QuantitySold]                         
    ,BDI.[GrossMargin]                          
    ,BDI.[ExternalSalesAgentID]                 
    ,BDI.[ExternalSalesAgent]                   
    ,BDI.[ProjectID]                            
    ,BDI.[Project]                              
    ,BDI.[SalesEmployeeID]                      
    ,BDI.[SalesEmployee]                        
    ,BDI.[GlobalParentID]                       
    ,BDI.[GlobalParent]                         
    ,BDI.[GlobalParentCalculatedID]             
    ,BDI.[GlobalParentCalculated]               
    ,BDI.[LocalParentID]                        
    ,BDI.[LocalParent]                          
    ,BDI.[LocalParentCalculatedID]              
    ,BDI.[LocalParentCalculated]                
    ,BDI.[SalesOrderTypeID]                     
    ,BDI.[BillToID]                             
    ,BDI.[BillTo]                               
    ,BDI.[FinNetAmountRealProduct]              
    ,BDI.[FinNetAmountFreight]                  
    ,BDI.[FinNetAmountMinQty]                   
    ,BDI.[FinNetAmountEngServ]                  
    ,BDI.[FinNetAmountMisc]                     
    ,BDI.[FinNetAmountServOther]                
    ,BDI.[FinNetAmountVerp]                     
    ,BDI.[FinRebateAccrual]                     
    ,BDI.[PaymentTermCashDiscountPercentageRate]
    ,BDI.[FinNetAmountOtherSales]               
    ,BDI.[FinReserveCashDiscount]               
    ,BDI.[FinNetAmountAllowances]               
    ,BDI.[FinSales100]                          
    ,BDI.[AccountingDate]                       
    ,BDI.[axbi_DataAreaID]                      
    ,BDI.[axbi_DataAreaName]                    
    ,BDI.[axbi_DataAreaGroup]                   
    ,BDI.[axbi_MaterialID]                      
    ,BDI.[axbi_CustomerID]                      
    ,BDI.[MaterialCalculated]                   
    ,BDI.[SoldToPartyCalculated]                
    ,BDI.[InOutID]                              
    ,BDI.[axbi_ItemNoCalc]                      
    ,BDT.[BillingDocumentType]    
    ,BDT.[SDDocumentCategory]     
    ,BDT.[IncrementItemNumber]    
    ,BDT.[BillingDocumentCategory]
FROM [edw].[fact_BillingDocumentItem] BDI
INNER JOIN [edw].[dim_BillingDocumentType] BDT
    ON BDI.BillingDocumentTypeID = BDT.BillingDocumentTypeID
WHERE UPPER(BDT.BillingDocumentType) NOT LIKE '%PROFORMA%'
    AND UPPER(BDT.BillingDocumentType) NOT LIKE '%PRO FORMA%'
    AND UPPER (
        COALESCE(
            BDI.ProductSurrogateKey
            ,''
        )
    ) NOT LIKE '%DUMMY%'
    AND BDI.CancelledInvoiceEffect = 'N'