CREATE PROC [edw].[sp_load_dim_ProductSalesDelivery]
	@t_jobId [varchar](36),
	@t_jobDtm [datetime],
	@t_lastActionCd [varchar](1),
	@t_jobBy [nvarchar](128)
AS
BEGIN
	TRUNCATE TABLE [edw].[dim_ProductSalesDelivery]

	INSERT INTO [edw].[dim_ProductSalesDelivery](
		 [nk_ProductSalesDelivery]
		,[ProductID]
		,[SalesOrganizationID]
		,[DistributionChannelID]
		,[Product]
		,[SalesOrganization]
		,[DistributionChannel]
		,[MinimumOrderQuantity]
		,[SupplyingPlant]
		,[PriceSpecificationProductGroup]
		,[AccountDetnProductGroup]
		,[DeliveryNoteProcMinDelivQty]
		,[ItemCategoryGroup]
		,[DeliveryQuantityUnit]
		,[DeliveryQuantity]
		,[ProductSalesStatus]
		,[ProductSalesStatusValidityDate]
		,[SalesMeasureUnit]
		,[IsMarkedForDeletion]
		,[ProductHierarchy]
		,[FirstSalesSpecProductGroup]
		,[SecondSalesSpecProductGroup]
		,[ThirdSalesSpecProductGroup]
		,[FourthSalesSpecProductGroup]
		,[FifthSalesSpecProductGroup]
		,[MinimumMakeToOrderOrderQty]
		,[LogisticsStatisticsGroup]
		,[VolumeRebateGroup]
		,[ProductCommissionGroup]
		,[CashDiscountIsDeductible]
		,[PricingReferenceProduct]
		,[AssortmentGrade]
		,[StoreListingProcedure]
		,[DistrCntrListingProcedure]
		,[StoreListingStartDate]
		,[StoreListingEndDate]
		,[DistrCntrListingStartDate]
		,[DistrCntrListingEndDate]
		,[StoreSaleStartDate]
		,[StoreSaleEndDate]
		,[DistrCntrSaleStartDate]
		,[DistrCntrSaleEndDate]
		,[RoundingProfile]
		,[ProductUnitGroup]
		,[MaxDeliveryQtyStoreOrder]
		,[PriceFixingCategory]
		,[VariableSalesUnitIsNotAllowed]
		,[CompetitionPressureCategory]
		,[ProductHasAttributeID01]
		,[ProductHasAttributeID02]
		,[ProductHasAttributeID03]
		,[ProductHasAttributeID04]
		,[ProductHasAttributeID05]
		,[ProductHasAttributeID06]
		,[ProductHasAttributeID07]
		,[ProductHasAttributeID08]
		,[ProductHasAttributeID09]
		,[ProductHasAttributeID10]
		,[IsActiveEntity]
		,[ProdExtAssortmentPriority]
		--,[BaseUnit]
		,[SubscrpnContrDfltDuration]
		,[SubscrpnContrAltvDuration1]
		,[SubscrpnContrAltvDuration2]
		,[SubscrpnContrDurationUnit]
		,[SubscrpnContrDfltExtnDurn]
		,[SubscrpnContrAltvExtnDurn1]
		,[SubscrpnContrAltvExtnDurn2]
		,[SubscrpnContrExtnDurnUnit]
		,[t_applicationId]
		,[t_jobId]
		,[t_jobDtm]
		,[t_lastActionCd]
		,[t_jobBy]
	)
	SELECT 
		 CONCAT_WS('_',psd.[Product], [ProductSalesOrg], [ProductDistributionChnl])
		,psd.[Product]
		,psd.[ProductSalesOrg]
		,psd.[ProductDistributionChnl]
		,pt.[Product]
		,st.[SalesOrganization]
		,dt.[DistributionChannel]
		,[MinimumOrderQuantity]
		,[SupplyingPlant]
		,[PriceSpecificationProductGroup]
		,[AccountDetnProductGroup]
		,[DeliveryNoteProcMinDelivQty]
		,psd.[ItemCategoryGroup]
		,[DeliveryQuantityUnit]
		,[DeliveryQuantity]
		,[ProductSalesStatus]
		,[ProductSalesStatusValidityDate]
		,[SalesMeasureUnit]
		,psd.[IsMarkedForDeletion]
		,psd.[ProductHierarchy]
		,[FirstSalesSpecProductGroup]
		,[SecondSalesSpecProductGroup]
		,[ThirdSalesSpecProductGroup]
		,[FourthSalesSpecProductGroup]
		,[FifthSalesSpecProductGroup]
		,[MinimumMakeToOrderOrderQty]
		,[LogisticsStatisticsGroup]
		,[VolumeRebateGroup]
		,[ProductCommissionGroup]
		,[CashDiscountIsDeductible]
		,[PricingReferenceProduct]
		,[AssortmentGrade]
		,[StoreListingProcedure]
		,[DistrCntrListingProcedure]
		,[StoreListingStartDate]
		,[StoreListingEndDate]
		,[DistrCntrListingStartDate]
		,[DistrCntrListingEndDate]
		,[StoreSaleStartDate]
		,[StoreSaleEndDate]
		,[DistrCntrSaleStartDate]
		,[DistrCntrSaleEndDate]
		,[RoundingProfile]
		,[ProductUnitGroup]
		,[MaxDeliveryQtyStoreOrder]
		,[PriceFixingCategory]
		,[VariableSalesUnitIsNotAllowed]
		,[CompetitionPressureCategory]
		,[ProductHasAttributeID01]
		,[ProductHasAttributeID02]
		,[ProductHasAttributeID03]
		,[ProductHasAttributeID04]
		,[ProductHasAttributeID05]
		,[ProductHasAttributeID06]
		,[ProductHasAttributeID07]
		,[ProductHasAttributeID08]
		,[ProductHasAttributeID09]
		,[ProductHasAttributeID10]
		,psd.[IsActiveEntity]
		,[ProdExtAssortmentPriority]
		--,[BaseUnit]
		,[SubscrpnContrDfltDuration]
		,[SubscrpnContrAltvDuration1]
		,[SubscrpnContrAltvDuration2]
		,[SubscrpnContrDurationUnit]
		,[SubscrpnContrDfltExtnDurn]
		,[SubscrpnContrAltvExtnDurn1]
		,[SubscrpnContrAltvExtnDurn2]
		,[SubscrpnContrExtnDurnUnit]
		,psd.[t_applicationId]
		,@t_jobId AS t_jobId
		,@t_jobDtm AS t_jobDtm
		,@t_lastActionCd AS t_lastActionCd
		,@t_jobBy AS t_jobBy
	FROM [base_s4h_uat_caa].[I_ProductSalesDelivery] AS psd
	LEFT JOIN
		[base_s4h_uat_caa].[I_ProductText] AS pt
		ON 
			psd.Product = pt.Product
			AND
			pt.[Language] = 'E'
	LEFT JOIN
		[base_s4h_uat_caa].[I_SalesOrganizationText] AS st
		ON 
			psd.[ProductSalesOrg] = st.[SalesOrganization]
			AND
			st.[Language] = 'E'
	LEFT JOIN
		[base_s4h_uat_caa].[I_DistributionChannelText] AS dt
		ON 
			psd.[ProductDistributionChnl] = dt.[DistributionChannel]
			AND
			dt.[Language] = 'E'
	where psd.[MANDT] = 200 and pt.[MANDT] = 200 and st.[MANDT] = 200 and dt.[MANDT] = 200
END