CREATE PROC [edw].[sp_load_dim_Supplier]
  @t_jobId [varchar](36)
, @t_jobDtm [datetime]
, @t_lastActionCd [varchar](1)
, @t_jobBy [nvarchar](128)
AS
BEGIN
 IF OBJECT_ID('syndw_xxxx_sls_d_euw_001.edw.dim_Supplier', 'U') is not null
        TRUNCATE TABLE [edw].[dim_Supplier]
    INSERT INTO [edw].[dim_Supplier] (
       [SupplierId]
      ,[SupplierAccountGroupId]
      ,[AccountGroup]
      ,[Supplier]
      ,[SupplierFullName]
      ,[IsBusinessPurposeCompleted]
      ,[CreatedByUser]
      ,[CreationDate]
      ,[IsOneTimeAccount]
      ,[AuthorizationGroup]
      ,[VATRegistration]
      ,[AccountIsBlockedForPosting]
      ,[TaxJurisdiction]
      ,[SupplierCorporateGroup]
      ,[Customer]
      ,[Industry]
      ,[TaxNumber1]
      ,[TaxNumber2]
      ,[TaxNumber3]
      ,[TaxNumber4]
      ,[TaxNumber5]
      ,[PostingIsBlocked]
      ,[PurchasingIsBlocked]
      ,[InternationalLocationNumber1]
      ,[InternationalLocationNumber2]
      ,[InternationalLocationNumber3]
      ,[AddressID]
      ,[Region]
      ,[OrganizationBPName1]
      ,[OrganizationBPName2]
      ,[CityName]
      ,[PostalCode]
      ,[StreetName]
      ,[Country]
      ,[ConcatenatedInternationalLocNo]
      ,[SupplierProcurementBlock]
      ,[SuplrQualityManagementSystem]
      ,[SuplrQltyInProcmtCertfnValidTo]
      ,[SupplierLanguage]
      ,[AlternativePayeeAccountNumber]
      ,[PhoneNumber1]
      ,[FaxNumber]
      ,[IsNaturalPerson]
      ,[TaxNumberResponsible]
      ,[UK_ContractorBusinessType]
      ,[UK_PartnerTradingName]
      ,[UK_PartnerTaxReference]
      ,[UK_VerificationStatus]
      ,[UK_VerificationNumber]
      ,[UK_CompanyRegistrationNumber]
      ,[UK_VerifiedTaxStatus]
      ,[FormOfAddress]
      ,[ReferenceAccountGroup]
      ,[VATLiability]
      ,[ResponsibleType]
      ,[TaxNumberType]
      ,[FiscalAddress]
      ,[BusinessType]
      ,[BirthDate]
      ,[PaymentIsBlockedForSupplier]
      ,[SortField]
      ,[PhoneNumber2]
      ,[DeletionIndicator]
      ,[TradingPartner]
      ,[TaxInvoiceRepresentativeName]
      ,[IndustryType]
      ,[t_applicationId]
      ,[t_jobId]
      ,[t_jobDtm]
      ,[t_lastActionCd]
      ,[t_jobBy])
    SELECT
       [Supplier] as [SupplierId]
      ,Supplier.[SupplierAccountGroup] as [SupplierAccountGroupId]
      ,SupplierAccountGroupText.[AccountGroupName] as [AccountGroup]
      ,[SupplierName] as [Supplier]
      ,[SupplierFullName]
      ,[IsBusinessPurposeCompleted]
      ,[CreatedByUser]
      ,[CreationDate]
      ,[IsOneTimeAccount]
      ,[AuthorizationGroup]
      ,[VATRegistration]
      ,[AccountIsBlockedForPosting]
      ,[TaxJurisdiction]
      ,[SupplierCorporateGroup]
      ,[Customer]
      ,[Industry]
      ,[TaxNumber1]
      ,[TaxNumber2]
      ,[TaxNumber3]
      ,[TaxNumber4]
      ,[TaxNumber5]
      ,[PostingIsBlocked]
      ,[PurchasingIsBlocked]
      ,[InternationalLocationNumber1]
      ,[InternationalLocationNumber2]
      ,[InternationalLocationNumber3]
      ,[AddressID]
      ,[Region]
      ,[OrganizationBPName1]
      ,[OrganizationBPName2]
      ,[CityName]
      ,[PostalCode]
      ,[StreetName]
      ,[Country]
      ,[ConcatenatedInternationalLocNo]
      ,[SupplierProcurementBlock]
      ,[SuplrQualityManagementSystem]
      ,[SuplrQltyInProcmtCertfnValidTo]
      ,[SupplierLanguage]
      ,[AlternativePayeeAccountNumber]
      ,[PhoneNumber1]
      ,[FaxNumber]
      ,[IsNaturalPerson]
      ,[TaxNumberResponsible]
      ,[UK_ContractorBusinessType]
      ,[UK_PartnerTradingName]
      ,[UK_PartnerTaxReference]
      ,[UK_VerificationStatus]
      ,[UK_VerificationNumber]
      ,[UK_CompanyRegistrationNumber]
      ,[UK_VerifiedTaxStatus]
      ,[FormOfAddress]
      ,[ReferenceAccountGroup]
      ,[VATLiability]
      ,[ResponsibleType]
      ,[TaxNumberType]
      ,[FiscalAddress]
      ,[BusinessType]
      ,[BirthDate]
      ,[PaymentIsBlockedForSupplier]
      ,[SortField]
      ,[PhoneNumber2]
      ,[DeletionIndicator]
      ,[TradingPartner]
      ,[TaxInvoiceRepresentativeName]
      ,[IndustryType]
      ,Supplier.t_applicationId
      ,@t_jobId AS t_jobId
      ,@t_jobDtm AS t_jobDtm
      ,@t_lastActionCd AS t_lastActionCd
      ,@t_jobBy AS t_jobBy
    FROM [base_s4h_uat_caa].[I_Supplier] Supplier
    LEFT JOIN [base_s4h_uat_caa].[I_SupplierAccountGroupText] SupplierAccountGroupText 
      ON Supplier.[SupplierAccountGroup] = SupplierAccountGroupText.[SupplierAccountGroup]
     AND SupplierAccountGroupText.[Language] = 'E' 
   WHERE Supplier.[MANDT] = 200 AND SupplierAccountGroupText.[MANDT] = 200
END
