CREATE PROC [edw].[sp_load_dim_CostCenter]
     @t_jobId [varchar](36)
    ,@t_jobDtm [datetime]
    ,@t_lastActionCd [varchar](1)
    ,@t_jobBy [nvarchar](128) 
AS
BEGIN

    IF OBJECT_ID('syndw_xxxx_sls_d_euw_001.edw.dim_CostCenter', 'U') is not null TRUNCATE TABLE [edw].[dim_CostCenter]

    INSERT INTO [edw].[dim_CostCenter](
       [ControllingArea]
      ,[CostCenterID]
      ,[CostCenter]
      ,[CostCenterDescription]
      ,[ValidityEndDate]
      ,[ValidityStartDate]
      ,[IsBlkdForPrimaryCostsPosting]
      ,[IsBlockedForPlanPrimaryCosts]
      ,[CompanyCode]
      ,[BusinessArea]
      ,[CostCenterCategory]
      ,[CostCtrResponsiblePersonName]
      ,[CostCtrResponsibleUser]
      ,[CostCenterCurrency]
      ,[CostingSheet]
      ,[TaxJurisdiction]
      ,[ProfitCenter]
      ,[Plant]
      ,[LogicalSystem]
      ,[CostCenterCreationDate]
      ,[CostCenterCreatedByUser]
      ,[IsBlkdForSecondaryCostsPosting]
      ,[IsBlockedForRevenuePosting]
      ,[IsBlockedForCommitmentPosting]
      ,[IsBlockedForPlanSecondaryCosts]
      ,[IsBlockedForPlanRevenues]
      ,[CostCenterAllocationMethod]
      ,[ConsumptionQtyIsRecorded]
      ,[Department]
      ,[SubsequentCostCenter]
      ,[ConditionUsage]
      ,[ConditionApplication]
      ,[CostCenterAccountingOverhead]
      ,[Country]
      ,[FormOfAddress]
      ,[AddressName]
      ,[AddressAdditionalName]
      ,[CostCenterAddrName3]
      ,[CostCenterAddrName4]
      ,[CityName]
      ,[District]
      ,[StreetAddressName]
      ,[POBox]
      ,[PostalCode]
      ,[POBoxPostalCode]
      ,[Region]
      ,[Language]
      ,[TeleboxNumber]
      ,[PhoneNumber1]
      ,[PhoneNumber2]
      ,[FaxNumber]
      ,[TeletexNumber]
      ,[TelexNumber]
      ,[DataCommunicationPhoneNumber]
      ,[CostCenterPrinterDestination]
      ,[CostCenterStandardHierArea]
      ,[CostCollector]
      ,[CostCenterIsComplete]
      ,[IsStatisticalCostCenter]
      ,[ObjectInternalID]
      ,[CostCenterFunction]
      ,[CostCenterAlternativeFunction]
      ,[FunctionalArea]
      ,[ActyIndepFormulaPlanningTmpl]
      ,[ActyDepdntFormulaPlanningTmpl]
      ,[ActyIndependentAllocationTmpl]
      ,[ActyDependentAllocationTmpl]
      ,[ActlIndepStatisticalKeyFigures]
      ,[ActlDepStatisticalKeyFigures]
      ,[JointVenture]
      ,[JointVentureRecoveryCode]
      ,[JointVentureEquityType]
      ,[JointVentureObjectType]
      ,[JointVentureClass]
      ,[JointVentureSubClass]
      ,[BudgetCarryingCostCenter]
      ,[AvailabilityControlProfile]
      ,[AvailabilityControlIsActive]
      ,[Fund]
      ,[GrantID]
      ,[FundIsFixAssigned]
      ,[GrantIDIsFixAssigned]
      ,[FunctionalAreaIsFixAssigned]
      ,[t_applicationId]
      ,[t_jobId]
      ,[t_jobDtm]
      ,[t_lastActionCd]
      ,[t_jobBy]
    )
    SELECT
       CostCenter.[ControllingArea]
      ,CostCenter.[CostCenter] as [CostCenterID]
      ,CostCenterText.[CostCenterName] as [CostCenter]
      ,CostCenterText.[CostCenterDescription]
      ,CostCenter.[ValidityEndDate]
      ,CostCenter.[ValidityStartDate]
      ,[IsBlkdForPrimaryCostsPosting]
      ,[IsBlockedForPlanPrimaryCosts]
      ,[CompanyCode]
      ,[BusinessArea]
      ,[CostCenterCategory]
      ,[CostCtrResponsiblePersonName]
      ,[CostCtrResponsibleUser]
      ,[CostCenterCurrency]
      ,[CostingSheet]
      ,[TaxJurisdiction]
      ,[ProfitCenter]
      ,[Plant]
      ,[LogicalSystem]
      ,[CostCenterCreationDate]
      ,[CostCenterCreatedByUser]
      ,[IsBlkdForSecondaryCostsPosting]
      ,[IsBlockedForRevenuePosting]
      ,[IsBlockedForCommitmentPosting]
      ,[IsBlockedForPlanSecondaryCosts]
      ,[IsBlockedForPlanRevenues]
      ,[CostCenterAllocationMethod]
      ,[ConsumptionQtyIsRecorded]
      ,[Department]
      ,[SubsequentCostCenter]
      ,[ConditionUsage]
      ,[ConditionApplication]
      ,[CostCenterAccountingOverhead]
      ,[Country]
      ,[FormOfAddress]
      ,[AddressName]
      ,[AddressAdditionalName]
      ,[CostCenterAddrName3]
      ,[CostCenterAddrName4]
      ,[CityName]
      ,[District]
      ,[StreetAddressName]
      ,[POBox]
      ,[PostalCode]
      ,[POBoxPostalCode]
      ,[Region]
      ,CostCenter.[Language]
      ,[TeleboxNumber]
      ,[PhoneNumber1]
      ,[PhoneNumber2]
      ,[FaxNumber]
      ,[TeletexNumber]
      ,[TelexNumber]
      ,[DataCommunicationPhoneNumber]
      ,[CostCenterPrinterDestination]
      ,[CostCenterStandardHierArea]
      ,[CostCollector]
      ,[CostCenterIsComplete]
      ,[IsStatisticalCostCenter]
      ,[ObjectInternalID]
      ,[CostCenterFunction]
      ,[CostCenterAlternativeFunction]
      ,[FunctionalArea]
      ,[ActyIndepFormulaPlanningTmpl]
      ,[ActyDepdntFormulaPlanningTmpl]
      ,[ActyIndependentAllocationTmpl]
      ,[ActyDependentAllocationTmpl]
      ,[ActlIndepStatisticalKeyFigures]
      ,[ActlDepStatisticalKeyFigures]
      ,[JointVenture]
      ,[JointVentureRecoveryCode]
      ,[JointVentureEquityType]
      ,[JointVentureObjectType]
      ,[JointVentureClass]
      ,[JointVentureSubClass]
      ,[BudgetCarryingCostCenter]
      ,[AvailabilityControlProfile]
      ,[AvailabilityControlIsActive]
      ,[Fund]
      ,[GrantID]
      ,[FundIsFixAssigned]
      ,[GrantIDIsFixAssigned]
      ,[FunctionalAreaIsFixAssigned]
      ,CostCenter.[t_applicationId]
      ,@t_jobId AS t_jobId
      ,@t_jobDtm AS t_jobDtm
      ,@t_lastActionCd AS t_lastActionCd
      ,@t_jobBy AS t_jobBy
    FROM 
        [base_s4h_uat_caa].[I_CostCenter] CostCenter
    LEFT JOIN 
        [base_s4h_uat_caa].[I_CostCenterText] CostCenterText
        ON 
            CostCenter.[CostCenter] = CostCenterText.[CostCenter]
            AND
            CostCenterText.[Language] = 'E'
        
END