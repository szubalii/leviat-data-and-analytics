CREATE PROC [edw].[sp_load_dim_Product] @t_jobId [varchar](36),@t_jobDtm [datetime],@t_lastActionCd [varchar](1),@t_jobBy [nvarchar](128) AS
BEGIN

    IF OBJECT_ID('syndw_xxxx_sls_d_euw_001.edw.dim_Product', 'U') is not null TRUNCATE TABLE [edw].[dim_Product]

    INSERT INTO [edw].[dim_Product](
       [ProductID]
      ,[ProductExternalID]
      ,[Product]
      ,[MaterialTypeID]
      ,[MaterialType]
      ,[CreationDate]
      ,[CreationTime]
      ,[CreationDateTime]
      ,[CreatedByUser]
      ,[LastChangeDate]
      ,[LastChangedByUser]
      ,[IsMarkedForDeletion]
      ,[CrossPlantStatus]
      ,[CrossPlantStatusValidityDate]
      ,[ProductOldID]
      ,[GrossWeight]
      ,[PurchaseOrderQuantityUnit]
      ,[SourceOfSupply]
      ,[WeightUnit]
      ,[CountryOfOrigin]
      ,[CompetitorID]
      ,[MaterialGroup]
      ,[BaseUnit]
      ,[ItemCategoryGroup]
      ,[NetWeight]
      ,[ProductHierarchy]
      ,[Product_L1_PillarID]   
      ,[Product_L2_GroupID]    
      ,[Product_L3_TypeID]     
      ,[Product_L4_FamilyID]   
      ,[Product_L5_SubFamilyID]
      ,[Product_L1_Pillar]     
      ,[Product_L2_Group]      
      ,[Product_L3_Type]       
      ,[Product_L4_Family]     
      ,[Product_L5_SubFamily]
      ,[Division]
      ,[VarblPurOrdUnitIsActive]
      ,[VolumeUnit]
      ,[MaterialVolume]
      ,[SalesStatus]
      ,[TransportationGroup]
      ,[SalesStatusValidityDate]
      ,[AuthorizationGroup]
      ,[ANPCode]
      ,[ProductCategory]
      ,[Brand]
      ,[ProcurementRule]
      ,[ValidityStartDate]
      ,[LowLevelCode]
      ,[ProdNoInGenProdInPrepackProd]
      ,[SerialIdentifierAssgmtProfile]
      ,[SizeOrDimensionText]
      ,[IndustryStandardName]
      ,[ProductStandardID]
      ,[InternationalArticleNumberCat]
      ,[ProductIsConfigurable]
      ,[IsBatchManagementRequired]
      ,[HasEmptiesBOM]
      ,[ExternalProductGroup]
      ,[CrossPlantConfigurableProduct]
      ,[SerialNoExplicitnessLevel]
      ,[ProductManufacturerNumber]
      ,[ManufacturerNumber]
      ,[ManufacturerPartProfile]
      ,[QltyMgmtInProcmtIsActive]
      ,[IsApprovedBatchRecordReqd]
      ,[HandlingIndicator]
      ,[WarehouseProductGroup]
      ,[WarehouseStorageCondition]
      ,[StandardHandlingUnitType]
      ,[SerialNumberProfile]
      ,[AdjustmentProfile]
      ,[PreferredUnitOfMeasure]
      ,[IsPilferable]
      ,[IsRelevantForHzdsSubstances]
      ,[QuarantinePeriod]
      ,[TimeUnitForQuarantinePeriod]
      ,[QualityInspectionGroup]
      ,[HandlingUnitType]
      ,[HasVariableTareWeight]
      ,[MaximumPackagingLength]
      ,[MaximumPackagingWidth]
      ,[MaximumPackagingHeight]
      ,[MaximumCapacity]
      ,[OvercapacityTolerance]
      ,[UnitForMaxPackagingDimensions]
      ,[BaseUnitSpecificProductLength]
      ,[BaseUnitSpecificProductWidth]
      ,[BaseUnitSpecificProductHeight]
      ,[ProductMeasurementUnit]
      ,[ProductValidStartDate]
      ,[ArticleCategory]
      ,[ContentUnit]
      ,[NetContent]
      ,[ComparisonPriceQuantity]
      ,[GrossContent]
      ,[ProductValidEndDate]
      ,[AssortmentListType]
      ,[HasTextilePartsWthAnimalOrigin]
      ,[ProductSeasonUsageCategory]
      ,[IndustrySector]
      ,[ChangeNumber]
      ,[MaterialRevisionLevel]
      ,[IsActiveEntity]
      ,[LastChangeDateTime]
      ,[LastChangeTime]
      ,[DangerousGoodsIndProfile]
      ,[ProductUUID]
      ,[ProdSupChnMgmtUUID22]
      ,[ProductDocumentChangeNumber]
      ,[ProductDocumentPageCount]
      ,[ProductDocumentPageNumber]
      ,[OwnInventoryManagedProduct]
      ,[DocumentIsCreatedByCAD]
      ,[ProductionOrInspectionMemoTxt]
      ,[ProductionMemoPageFormat]
      ,[GlobalTradeItemNumberVariant]
      ,[ProductIsHighlyViscous]
      ,[TransportIsInBulk]
      ,[ProdAllocDetnProcedure]
      ,[ProdEffctyParamValsAreAssigned]
      ,[ProdIsEnvironmentallyRelevant]
      ,[LaboratoryOrDesignOffice]
      ,[PackagingMaterialGroup]
      ,[ProductIsLocked]
      ,[DiscountInKindEligibility]
      ,[SmartFormName]
      ,[PackingReferenceProduct]
      ,[BasicMaterial]
      ,[ProductDocumentNumber]
      ,[ProductDocumentVersion]
      ,[ProductDocumentType]
      ,[ProductDocumentPageFormat]
      ,[ProductConfiguration]
      ,[SegmentationStrategy]
      ,[SegmentationIsRelevant]
      ,[IsChemicalComplianceRelevant]
      ,[LogisticalProductCategory]
      ,[SalesProduct]
      --,[ProdCharc1InternalNumber]
      --,[ProdCharc2InternalNumber]
      --,[ProdCharc3InternalNumber]
      --,[ProductCharacteristic1]
      --,[ProductCharacteristic2]
      --,[ProductCharacteristic3]
      ,[DfsAmmunitionGroupCode]
      ,[DfsRICIdentifier]
      --,[DfsProductSensitivity]
      --,[DfsManufacturerPartLongNumber]
      --,[DfsMatlConditionMgmt]
      --,[DfsReturnDelivery]
      --,[DfsLogisticsLevel]
      --,[DfsNationalItemIdnNumber]
      ,[ZZ1_CustomFieldRiskMit_PRD]
      ,[ZZ1_CustomFieldHighRis_PRD]
      ,[ZZ1_CustomFieldRiskRea_PRD]
      ,[t_applicationId]
      ,[t_jobId]
      ,[t_jobDtm]
      ,[t_lastActionCd]
      ,[t_jobBy]
    )
    SELECT 
         product.[Product] as [ProductID]
        ,[ProductExternalID]
        ,pr_text.[ProductName] as [Product]
        ,product.[ProductType] as [MaterialTypeID]
        ,type_text.[MaterialTypeName] as [MaterialType]
        ,[CreationDate]
        ,[CreationTime]
        ,NULL AS [CreationDateTime]
        ,[CreatedByUser]
        ,[LastChangeDate]
        ,[LastChangedByUser]
        ,[IsMarkedForDeletion]
        ,[CrossPlantStatus]
        ,[CrossPlantStatusValidityDate]
        ,[ProductOldID]
        ,[GrossWeight]
        ,[PurchaseOrderQuantityUnit]
        ,[SourceOfSupply]
        ,[WeightUnit]
        ,[CountryOfOrigin]
        ,[CompetitorID]
        ,[ProductGroup]
        ,[BaseUnit]
        ,[ItemCategoryGroup]
        ,[NetWeight]
        ,[ProductHierarchy]
        ,[Product_L1_PillarID]   
        ,[Product_L2_GroupID]    
        ,[Product_L3_TypeID]     
        ,[Product_L4_FamilyID]   
        ,[Product_L5_SubFamilyID]
        ,[Product_L1_Pillar]     
        ,[Product_L2_Group]      
        ,[Product_L3_Type]       
        ,[Product_L4_Family]     
        ,[Product_L5_SubFamily]
        ,[Division]
        ,[VarblPurOrdUnitIsActive]
        ,[VolumeUnit]
        ,[MaterialVolume]
        ,[SalesStatus]
        ,[TransportationGroup]
        ,[SalesStatusValidityDate]
        ,[AuthorizationGroup]
        ,[ANPCode]
        ,[ProductCategory]
        ,[Brand]
        ,[ProcurementRule]
        ,[ValidityStartDate]
        ,[LowLevelCode]
        ,[ProdNoInGenProdInPrepackProd]
        ,[SerialIdentifierAssgmtProfile]
        ,[SizeOrDimensionText]
        ,[IndustryStandardName]
        ,[ProductStandardID]
        ,[InternationalArticleNumberCat]
        ,[ProductIsConfigurable]
        ,[IsBatchManagementRequired]
        ,[HasEmptiesBOM]
        ,[ExternalProductGroup]
        ,[CrossPlantConfigurableProduct]
        ,[SerialNoExplicitnessLevel]
        ,[ProductManufacturerNumber]
        ,[ManufacturerNumber]
        ,[ManufacturerPartProfile]
        ,[QltyMgmtInProcmtIsActive]
        ,[IsApprovedBatchRecordReqd]
        ,[HandlingIndicator]
        ,[WarehouseProductGroup]
        ,[WarehouseStorageCondition]
        ,[StandardHandlingUnitType]
        ,[SerialNumberProfile]
        ,[AdjustmentProfile]
        ,[PreferredUnitOfMeasure]
        ,[IsPilferable]
        ,[IsRelevantForHzdsSubstances]
        ,[QuarantinePeriod]
        ,[TimeUnitForQuarantinePeriod]
        ,[QualityInspectionGroup]
        ,[HandlingUnitType]
        ,[HasVariableTareWeight]
        ,[MaximumPackagingLength]
        ,[MaximumPackagingWidth]
        ,[MaximumPackagingHeight]
        ,[MaximumCapacity]
        ,[OvercapacityTolerance]
        ,[UnitForMaxPackagingDimensions]
        ,[BaseUnitSpecificProductLength]
        ,[BaseUnitSpecificProductWidth]
        ,[BaseUnitSpecificProductHeight]
        ,[ProductMeasurementUnit]
        ,[ProductValidStartDate]
        ,[ArticleCategory]
        ,[ContentUnit]
        ,[NetContent]
        ,[ComparisonPriceQuantity]
        ,[GrossContent]
        ,[ProductValidEndDate]
        ,[AssortmentListType]
        ,[HasTextilePartsWthAnimalOrigin]
        ,[ProductSeasonUsageCategory]
        ,[IndustrySector]
        ,[ChangeNumber]
        ,[MaterialRevisionLevel]
        ,[IsActiveEntity]
        ,NULL AS [LastChangeDateTime]
        ,[LastChangeTime]
        ,[DangerousGoodsIndProfile]
        ,[ProductUUID]
        ,[ProdSupChnMgmtUUID22]
        ,[ProductDocumentChangeNumber]
        ,[ProductDocumentPageCount]
        ,[ProductDocumentPageNumber]
        ,[OwnInventoryManagedProduct]
        ,[DocumentIsCreatedByCAD]
        ,[ProductionOrInspectionMemoTxt]
        ,[ProductionMemoPageFormat]
        ,[GlobalTradeItemNumberVariant]
        ,[ProductIsHighlyViscous]
        ,[TransportIsInBulk]
        ,[ProdAllocDetnProcedure]
        ,[ProdEffctyParamValsAreAssigned]
        ,[ProdIsEnvironmentallyRelevant]
        ,[LaboratoryOrDesignOffice]
        ,[PackagingMaterialGroup]
        ,[ProductIsLocked]
        ,[DiscountInKindEligibility]
        ,[SmartFormName]
        ,[PackingReferenceProduct]
        ,[BasicMaterial]
        ,[ProductDocumentNumber]
        ,[ProductDocumentVersion]
        ,[ProductDocumentType]
        ,[ProductDocumentPageFormat]
        ,[ProductConfiguration]
        ,[SegmentationStrategy]
        ,[SegmentationIsRelevant]
        ,[IsChemicalComplianceRelevant]
        ,[LogisticalProductCategory]
        ,[SalesProduct]
        --,[ProdCharc1InternalNumber]
        --,[ProdCharc2InternalNumber]
        --,[ProdCharc3InternalNumber]
        --,[ProductCharacteristic1]
        --,[ProductCharacteristic2]
        --,[ProductCharacteristic3]
        ,[DfsAmmunitionGroupCode]
        ,[DfsRICIdentifier]
        --,[DfsProductSensitivity]
        --,[DfsManufacturerPartLongNumber]
        --,[DfsMatlConditionMgmt]
        --,[DfsReturnDelivery]
        --,[DfsLogisticsLevel]
        --,[DfsNationalItemIdnNumber]
        ,NULL AS [ZZ1_CustomFieldRiskMit_PRD]
        ,NULL AS [ZZ1_CustomFieldHighRis_PRD]
        ,NULL AS [ZZ1_CustomFieldRiskRea_PRD]
        ,product.[t_applicationId]
        ,@t_jobId AS t_jobId
        ,@t_jobDtm AS t_jobDtm
        ,@t_lastActionCd AS t_lastActionCd
        ,@t_jobBy AS t_jobBy
    FROM 
        [base_s4h_uat_caa].[I_Product] product
    LEFT JOIN 
        [base_s4h_uat_caa].[I_ProductText] pr_text
        ON 
            product.[Product] = pr_text.[Product]
            AND
            pr_text.[Language] = 'E'
    LEFT JOIN 
        [base_s4h_uat_caa].[I_ProductTypeText] type_text
        ON
            product.[ProductType] = type_text.[ProductType]
            AND
            type_text.[Language] = 'E'
    LEFT JOIN 
        [edw].[dim_ProductHierarchy] prodhier
        ON
            product.[ProductHierarchy] = prodhier.[ProductHierarchyNode]
   where product.MANDT = 200 
   and pr_text.MANDT = 200 
   and type_text.MANDT = 200        
END