CREATE TABLE [edw].[fact_PurchasingDocumentItem]
(
  [sk_fact_PurchasingDocumentItem] bigint IDENTITY(1, 1) NOT NULL,
  [PurchasingDocument]             nvarchar(10)  NOT NULL,
  [PurchasingDocumentItem]         char(5)       NOT NULL,
  [MaterialID]                     nvarchar(40) ,
  [PurchasingDocumentItemText]     nvarchar(40) ,
  [DocumentCurrencyID]             nchar(5) ,
--edw.vw_Currency	Currency		X           PurchaseOrderCurrency		
  [PlantID]                        nvarchar(4) ,
  [CompanyCodeID]                  nvarchar(4) ,
  [MaterialGroupID]                nvarchar(9) ,
  [PurchaseContract]               nvarchar(10) ,
  [PurchaseContractItem]           char(5) ,
  [NetAmount]                      decimal(13, 2),
  [PurchaseOrderQuantity]          decimal(13, 3),
  [StorageLocationID]              nvarchar(4) ,
  [OrderPriceUnit]                 nvarchar(3) ,
  [NetPriceAmount]                 decimal(11, 2),
  [NetPriceQuantity]               decimal(13, 3),
  [PurchasingDocumentItemCategoryID] nvarchar(1) ,
  [NextDeliveryOpenQuantity]       decimal(13, 3),
  [NextDeliveryDate]               date,
  [IsCompletelyDelivered]          nvarchar(1) ,
  [OrderQuantityUnit]              nvarchar(3) ,
  [CostCenterID]                   nvarchar(10) ,
  [GLAccountID]                    nvarchar(10) ,
  [GoodsReceiptQuantity]           decimal(13, 3),
  [PurchaseRequisition]            nvarchar(10) ,
  [PurchaseRequisitionItem]        char(5) ,
  [IsReturnsItem]                  nvarchar(1) ,
  [t_applicationId]                VARCHAR(32),
  [t_extractionDtm]                DATETIME,
  [t_jobId]                        VARCHAR(36),
  [t_jobDtm]                       DATETIME,
  [t_lastActionCd]                 VARCHAR(1),
  [t_jobBy]                        NVARCHAR(128),
  CONSTRAINT [PK_fact_PurchasingDocumentItem] PRIMARY KEY NONCLUSTERED ([PurchasingDocument], [PurchasingDocumentItem]) NOT ENFORCED
)
WITH ( DISTRIBUTION = HASH (PurchasingDocument), CLUSTERED COLUMNSTORE INDEX )
GO
