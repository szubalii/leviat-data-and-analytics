CREATE VIEW [dm_sales].[vw_fact_SalesOrderItem_filtered] 
AS

SELECT SOI.[SalesOrderID]
    ,SOI.[SalesOrderItemID]
    ,SOI.[CurrencyTypeID]
    ,SOI.[CurrencyType]
    ,SOI.[CurrencyID]
    ,SOI.[SDDocumentCategoryID]
    ,SOI.[SDDocumentCategory]
    ,SOI.[SalesDocumentTypeID]
    ,SOI.[SalesDocumentType]
    ,SOI.[SalesDocumentItemCategoryID]
    ,SOI.[SalesDocumentItemCategory]
    ,SOI.[IsReturnsItemID]
    ,SOI.[CreationDate]
    ,SOI.[CreationTime]
    ,SOI.[LastChangeDate]
    ,SOI.[SalesOrganizationID]   
    ,SOI.[DistributionChannelID]
    ,SOI.[DistributionChannel]
    ,SOI.[MaterialID]
    ,SOI.[ProductSurrogateKey]
    ,SOI.[OriginallyRequestedMaterialID]
    ,SOI.[MaterialSubstitutionReasonID]
    ,SOI.[MaterialGroupID]
    ,SOI.[BrandID]
    ,SOI.[Brand]
    ,SOI.[SoldToPartyID]
    ,SOI.[ShipToPartyID]
    ,SOI.[PayerPartyID]
    ,SOI.[BillToPartyID]
    ,SOI.[SDDocumentReasonID]
    ,SOI.[SDDocumentReason]
    ,SOI.[SalesDocumentDate]
    ,SOI.[OrderQuantity]
    ,SOI.[OrderQuantityUnitID]
    ,SOI.[OrderQuantityUnit]
    ,SOI.[TargetQuantity]
    ,SOI.[TargetQuantityUnitID]
    ,SOI.[ServicesRenderedDate]
    ,SOI.[SalesDistrictID]
    ,SOI.[CustomerGroupID]
    ,SOI.[CustomerGroup]
    ,SOI.[SalesDocumentRjcnReasonID]
    ,SOI.[SalesDocumentRjcnReason]
    ,SOI.[PricingDate]
    ,SOI.[ExchangeRateDate]
    ,SOI.[NetAmount]
    ,SOI.[TransactionCurrencyID]
    ,SOI.[RequestedDeliveryDate]
    ,SOI.[PlantID]
    ,SOI.[StorageLocationID]
    ,SOI.[BillingDocumentDate]
    ,SOI.[BillingCompanyCodeID]
    ,SOI.[ProfitCenterID]
    ,SOI.[ReferenceSDDocumentItemSurrogateKey]
    ,SOI.[ReferenceSDDocumentID]
    ,SOI.[ReferenceSDDocumentItemID]
    ,SOI.[ReferenceSDDocumentCategoryID]
    ,SOI.[ReferenceSDDocumentCategory]
    ,SOI.[OriginSDDocumentID]
    ,SOI.[OriginSDDocumentItemID]
    ,SOI.[OverallSDProcessStatusID]
    ,SOI.[OverallSDProcessStatus]
    ,SOI.[OverallTotalDeliveryStatusID]
    ,SOI.[OverallTotalDeliveryStatus]
    ,SOI.[OverallOrdReltdBillgStatusID]
    ,SOI.[TotalCreditCheckStatusID]
    ,SOI.[TotalCreditCheckStatus]
    ,SOI.[DeliveryBlockStatusID]
    ,SOI.[DeliveryBlockStatus]
    ,SOI.[BillingBlockStatusID]
    ,SOI.[BillingBlockStatus]
    ,SOI.[TotalSDDocReferenceStatusID]
    ,SOI.[TotalSDDocReferenceStatus]
    ,SOI.[SDDocReferenceStatusID]
    ,SOI.[SDDocReferenceStatus]
    ,SOI.[OverallSDDocumentRjcnStatusID]
    ,SOI.[OverallSDDocumentRejectionSts]
    ,SOI.[SDDocumentRejectionStatusID]
    ,SOI.[SDDocumentRejectionStatus]
    ,SOI.[OverallTotalSDDocRefStatusID]
    ,SOI.[OverallTotalSDDocRefStatus]
    ,SOI.[OverallSDDocReferenceStatusID]
    ,SOI.[OverallSDDocReferenceStatus]
    ,SOI.[ItemGeneralIncompletionStatusID]
    ,SOI.[ItemGeneralIncompletionStatus]
    ,SOI.[ItemBillingIncompletionStatusID]
    ,SOI.[ItemBillingIncompletionStatus]
    ,SOI.[PricingIncompletionStatusID]
    ,SOI.[PricingIncompletionStatus]
    ,SOI.[ItemDeliveryIncompletionStatusID]
    ,SOI.[ItemDeliveryIncompletionStatus]
    ,SOI.[ExternalSalesAgentID]
    ,SOI.[ExternalSalesAgent]
    ,SOI.[ProjectID]
    ,SOI.[Project]
    ,SOI.[SalesEmployeeID]
    ,SOI.[SalesEmployee]
    ,SOI.[GlobalParentCalculatedID]
    ,SOI.[GlobalParentCalculated]
    ,SOI.[LocalParentCalculatedID]
    ,SOI.[LocalParentCalculated]
    ,SOI.[Margin]
    ,SOI.[Subtotal1Amount]
    ,SOI.[Subtotal2Amount]
    ,SOI.[Subtotal3Amount]
    ,SOI.[Subtotal4Amount]
    ,SOI.[Subtotal5Amount]
    ,SOI.[Subtotal6Amount]
    ,SOI.[InOutID]
    ,SOI.[OrderType]
    ,SOIC.[ItemOrderStatus]
    ,SOIC.[OrderStatus]
    ,SOI.[SalesOfficeID]
    ,SOI.[SalesOffice]
    ,SOI.[CostAmount]
    ,SOIC.[ExpectedDeliveryDate]
    ,SOI.[t_applicationId]
    ,SOI.[t_extractionDtm]
FROM [dm_sales].[vw_fact_SalesOrderItem] SOI
INNER JOIN [edw].[vw_SalesOrderItem_combined] SOIC
    ON  SOI.SalesOrderID = SOIC.SalesDocument
    AND SOI.SalesOrderItemID = SOIC.SalesDocumentItem