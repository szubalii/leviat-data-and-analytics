CREATE VIEW [dm_sales].[vw_fact_SalesOrderItem_filtered] 
AS
SELECT    
     [sk_fact_SalesDocumentItem]
    ,[SalesOrderID]
    ,[SalesOrderItemID]
    ,[CurrencyTypeID]
    ,[CurrencyType]
    ,[CurrencyID]
    ,[SDDocumentCategoryID]
    ,[SDDocumentCategory]
    ,[SalesDocumentTypeID]
    ,[SalesDocumentType]
    ,[SalesDocumentItemCategoryID]
    ,[SalesDocumentItemCategory]
    ,[IsReturnsItemID]
    ,[CreationDate]
    ,[CreationTime]
    ,[LastChangeDate]
    ,[SalesOrganizationID]   
    ,[DistributionChannelID]
    ,[DistributionChannel]
    ,[MaterialID]
    ,[nk_ProductPlant]
    ,[ProductSurrogateKey]
    ,[OriginallyRequestedMaterialID]
    ,[MaterialSubstitutionReasonID]
    ,[MaterialGroupID]
    ,[BrandID]
    ,[Brand]
    ,[SoldToPartyID]
    ,[ShipToPartyID]
    ,[PayerPartyID]
    ,[BillToPartyID]
    ,[SDDocumentReasonID]
    ,[SDDocumentReason]
    ,[SalesDocumentDate]
    ,[OrderQuantity]
    ,[OrderQuantityUnitID]
    ,[OrderQuantityUnit]
    ,[TargetQuantity]
    ,[TargetQuantityUnitID]
    ,[ServicesRenderedDate]
    ,[SalesDistrictID]
    ,[CustomerGroupID]
    ,[CustomerGroup]
    ,[SalesDocumentRjcnReasonID]
    ,[SalesDocumentRjcnReason]
    ,[PricingDate]
    ,[ExchangeRateDate]
    ,[NetAmount]
    ,[TransactionCurrencyID]
    ,[RequestedDeliveryDate]
    ,[PlantID]
    ,[StorageLocationID]
    ,[BillingDocumentDate]
    ,[BillingCompanyCodeID]
    ,[ProfitCenterID]
    ,[ReferenceSDDocumentItemSurrogateKey]
    ,[ReferenceSDDocumentID]
    ,[ReferenceSDDocumentItemID]
    ,[ReferenceSDDocumentCategoryID]
    ,[ReferenceSDDocumentCategory]
    ,[OriginSDDocumentID]
    ,[OriginSDDocumentItemID]
    ,[OverallSDProcessStatusID]
    ,[OverallSDProcessStatus]
    ,[OverallTotalDeliveryStatusID]
    ,[OverallTotalDeliveryStatus]
    ,[OverallOrdReltdBillgStatusID]
    ,[TotalCreditCheckStatusID]
    ,[TotalCreditCheckStatus]
    ,[DeliveryBlockStatusID]
    ,[DeliveryBlockStatus]
    ,[BillingBlockStatusID]
    ,[BillingBlockStatus]
    ,[TotalSDDocReferenceStatusID]
    ,[TotalSDDocReferenceStatus]
    ,[SDDocReferenceStatusID]
    ,[SDDocReferenceStatus]
    ,[OverallSDDocumentRjcnStatusID]
    ,[OverallSDDocumentRejectionSts]
    ,[SDDocumentRejectionStatusID]
    ,[SDDocumentRejectionStatus]
    ,[OverallTotalSDDocRefStatusID]
    ,[OverallTotalSDDocRefStatus]
    ,[OverallSDDocReferenceStatusID]
    ,[OverallSDDocReferenceStatus]
    ,[ItemGeneralIncompletionStatusID]
    ,[ItemGeneralIncompletionStatus]
    ,[ItemBillingIncompletionStatusID]
    ,[ItemBillingIncompletionStatus]
    ,[PricingIncompletionStatusID]
    ,[PricingIncompletionStatus]
    ,[ItemDeliveryIncompletionStatusID]
    ,[ItemDeliveryIncompletionStatus]
    ,[SalesAgentID]
    ,[SalesAgent]
    ,[ExternalSalesAgentID]
    ,[ExternalSalesAgent]
    ,[ProjectID]
    ,[Project]
    ,[SalesEmployeeID]
    ,[SalesEmployee]
    ,[GlobalParentCalculatedID]
    ,[GlobalParentCalculated]
    ,[LocalParentCalculatedID]
    ,[LocalParentCalculated]
    ,[Margin]
    ,[Subtotal1Amount]
    ,[Subtotal2Amount]
    ,[Subtotal3Amount]
    ,[Subtotal4Amount]
    ,[Subtotal5Amount]
    ,[Subtotal6Amount]
    ,[InOutID]
    ,[OrderType]
    ,[ItemOrderStatus]
    ,[OrderStatus]
    ,[SalesOfficeID]
    ,[SalesOffice]
    ,[CostAmount]
    ,NULL as [ExpectedDeliveryDate]
    ,[HeaderBillingBlockReasonID]
    ,[ItemBillingBlockReasonID]
    ,[DeliveryBlockReasonID]
    , [HDR_PlannedGoodsIssueDate]
    , [HDR_ShippingPointID]
    , [HDR_HeaderBillingBlockReason]
    , [HDR_TotalBlockStatusID]
    , [HDR_ShipmentBlockReason]
    , [HDR_DeliveryBlockReason]
    , [CreatedByUserID]
    , [LatestOutboundDelivery]
    , [LatestOutboundDeliveryItem]
    ,[IsOrderItemBlockedFlag]
    ,[t_applicationId]
    ,[t_extractionDtm]
FROM [dm_sales].[vw_fact_SalesOrderItem]
WHERE [SDDocumentRejectionStatus] <> 'Fully Rejected'
