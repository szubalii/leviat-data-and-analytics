CREATE VIEW [dm_sales].[vw_fact_SalesOrderItem_narrow]
AS
SELECT
     SOI.[SalesOrderID]
    ,SOI.[SalesOrderItemID]
    ,SOI.[SalesOrderCreationDate]
    ,SOI.[BillingDocumentDate]
    ,SOI.[CurrencyType]
    ,SOI.[SalesDocumentType]
    ,SOI.[MaterialID]
    ,SOI.[OrderQuantity]
    ,SOI.[OrderQuantityUnitID]
    ,SOI.[CurrencyID]
    ,SOI.[InOutID]
    ,SOI.[SalesOrganizationID]
    ,SOI.[RequestedDeliveryDate]
    ,SOI.[ActualDeliveredQuantityInBaseUnit]
    ,SOI.[BillingQuantityInBaseUnit]
    ,SOI.[ActualDeliveredQuantityIBUOverall]
    ,SOI.[BillingQuantityIBUOverall]
    ,SOI.[OrderStatus]
    ,SOI.[ItemOrderStatus]
    ,SOI.[OrderType]
    ,SOI.[ItemDeliveryStatus]    
    ,SOI.[OverallDeliveryStatus]
    ,SOI.[ShippingConditionID]
    ,SOI.[SOI_NetAmount]
    ,SOI.[BillingDocument]                      
    ,SOI.[BillingDocumentItem]                  
    ,SOI.[BillingDocumentCurrencyTypeID]      
    ,SOI.[BillingDocumentTypeID]                
    ,SOI.[BillingDocumentCategoryID]            
    ,SOI.[BillingDocumentSDDocumentCategoryID]                 
    ,SOI.[BillingDocumentCreationDate]                    
    ,SOI.[BillingDocumentCreationTime]                                           
    ,SOI.[BillingDocumentIsTemporary]           
    ,SOI.[BillingDocumentProductSurrogateKey]                      
    ,SOI.[BillingDocumentIsCancelled]           
    ,SOI.[CancelledBillingDocument]             
    ,SOI.[CancelledInvoiceEffect]                     
    ,SOI.[BillingQuantity]                      
    ,SOI.[BillingQuantityUnitID]                
    ,SOI.[BillingDocumentQuantityIBU]                           
    ,SOI.[MRPRequiredQuantityInBaseUnit]                 
    ,SOI.[ItemGrossWeight]                      
    ,SOI.[ItemNetWeight]                      
    ,SOI.[ItemVolume]                           
    ,SOI.[BillingDocumentNetAmount]                       
    ,SOI.[GrossAmount]                            
    ,SOI.[TaxAmount]                            
    ,SOI.[BillingDocumentCostAmount]              
    ,SOI.[OriginSDDocument]                     
    ,SOI.[OriginSDDocumentItem]         
    ,SOI.[BillingDocumentReferenceDocument]                
    ,SOI.[BillingDocumentReferenceDocumentItem]            
    ,SOI.[BillingDocumentReferenceDocumentCategoryID]       
    ,SOI.[SalesDocumentID]                      
    ,SOI.[SalesDocumentItemID]                  
    ,SOI.[SalesSDDocumentCategoryID]                            
    ,SOI.[BillingDocumentType]    
    ,SOI.[BillingDocumentSDDocumentCategory]     
    ,SOI.[BillingDocumentCategory]
    ,ODI.[OutboundDelivery]
    ,ODI.[OutboundDeliveryItem]
    ,ODI.[DeliveryDocumentItemCategoryID]
    ,ODI.[SalesDocumentItemTypeID]
    ,ODI.[CreatedByUserID]
    ,ODI.[OutboundDeliveryCreationDate]
    ,ODI.[OutboundDeliveryCreationTime]
    ,ODI.[DistributionChannelID]
    ,ODI.[ProductID]
    ,ODI.[OriginallyRequestedMaterialID]
    ,ODI.[ProductGroupID]
    ,ODI.[ActualDeliveredQtyInBaseUnit]
    ,ODI.[OutboundDeliveryReferenceDocument]
    ,ODI.[OutboundDeliveryReferenceDocumentItem]
    ,ODI.[OutboundDeliveryReferenceDocumentCategoryID]
    ,SOI.[ScheduleLine]
    ,SOI.[dimSDSLScheduleLineCategory]
    ,SOI.[dimSDSLOrderQuantityUnit]
    ,SOI.[IsRequestedDelivSchedLine]
    ,SOI.[ScheduleLineOrderQuantity]
    ,SOI.[CorrectedQtyInOrderQtyUnit]
    ,SOI.[IsConfirmedDelivSchedLine]
    ,SOI.[ConfirmedDeliveryDate]
    ,SOI.[ScheduleLineConfirmationStatus]
    ,SOI.[DeliveredQtyInOrderQtyUnit]
    ,SOI.[DeliveredQuantityInBaseUnit]
    ,SOI.[ConfdOrderQtyByMatlAvailCheck]
    ,SOI.[ExpectedDeliveryDate]
FROM [dm_sales].[vw_SalesOrderItem_combined] SOI
LEFT JOIN [edw].[vw_OutboundDeliveryItem_for_SalesDocumentItem] ODI
    ON SOI.SalesOrderID = ODI.ReferenceSDDocument
    AND SOI.SalesOrderItemID = ODI.ReferenceSDDocumentItem

